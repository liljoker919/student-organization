/*!
 * Bootstrap v5.3.6 JavaScript (minimal version)
 * Essential Bootstrap JS for Student Organization app
 */

// Basic Bootstrap functionality for modals, collapse, and tooltips
(function() {
  'use strict';

  // Collapse functionality for navbar
  function initCollapse() {
    const collapseToggles = document.querySelectorAll('[data-bs-toggle="collapse"]');
    
    collapseToggles.forEach(toggle => {
      toggle.addEventListener('click', function(e) {
        e.preventDefault();
        const targetSelector = this.getAttribute('data-bs-target');
        const target = document.querySelector(targetSelector);
        
        if (target) {
          if (target.classList.contains('show')) {
            target.classList.remove('show');
          } else {
            target.classList.add('show');
          }
        }
      });
    });
  }

  // Modal functionality
  function initModals() {
    const modalToggles = document.querySelectorAll('[data-bs-toggle="modal"]');
    const modalDismisses = document.querySelectorAll('[data-bs-dismiss="modal"]');
    
    modalToggles.forEach(toggle => {
      toggle.addEventListener('click', function(e) {
        e.preventDefault();
        const targetSelector = this.getAttribute('data-bs-target');
        const target = document.querySelector(targetSelector);
        
        if (target) {
          target.style.display = 'block';
          target.classList.add('show');
          document.body.style.overflow = 'hidden';
          
          // Add backdrop
          const backdrop = document.createElement('div');
          backdrop.className = 'modal-backdrop fade show';
          backdrop.style.cssText = 'position: fixed; top: 0; left: 0; z-index: 1050; width: 100vw; height: 100vh; background-color: #000; opacity: 0.5;';
          document.body.appendChild(backdrop);
          
          // Close modal when clicking backdrop
          backdrop.addEventListener('click', function() {
            closeModal(target);
          });
        }
      });
    });
    
    modalDismisses.forEach(dismiss => {
      dismiss.addEventListener('click', function(e) {
        e.preventDefault();
        const modal = this.closest('.modal');
        if (modal) {
          closeModal(modal);
        }
      });
    });
    
    // Close modal on escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        const openModal = document.querySelector('.modal.show');
        if (openModal) {
          closeModal(openModal);
        }
      }
    });
  }
  
  function closeModal(modal) {
    modal.style.display = 'none';
    modal.classList.remove('show');
    document.body.style.overflow = '';
    
    // Remove backdrop
    const backdrop = document.querySelector('.modal-backdrop');
    if (backdrop) {
      backdrop.remove();
    }
  }

  // Tooltip functionality (basic)
  function initTooltips() {
    const tooltipElements = document.querySelectorAll('[data-bs-toggle="tooltip"]');
    
    tooltipElements.forEach(element => {
      element.addEventListener('mouseenter', function() {
        const tooltipText = this.getAttribute('title') || this.getAttribute('data-bs-title');
        if (tooltipText) {
          const tooltip = document.createElement('div');
          tooltip.className = 'tooltip bs-tooltip-top show';
          tooltip.innerHTML = `<div class="tooltip-arrow"></div><div class="tooltip-inner">${tooltipText}</div>`;
          tooltip.style.cssText = 'position: absolute; z-index: 1070; background: #000; color: #fff; padding: 4px 8px; border-radius: 4px; font-size: 12px; max-width: 200px;';
          
          document.body.appendChild(tooltip);
          
          // Position tooltip
          const rect = this.getBoundingClientRect();
          tooltip.style.left = rect.left + (rect.width / 2) - (tooltip.offsetWidth / 2) + 'px';
          tooltip.style.top = rect.top - tooltip.offsetHeight - 5 + 'px';
          
          this._tooltip = tooltip;
        }
      });
      
      element.addEventListener('mouseleave', function() {
        if (this._tooltip) {
          this._tooltip.remove();
          this._tooltip = null;
        }
      });
    });
  }

  // Initialize when DOM is ready
  document.addEventListener('DOMContentLoaded', function() {
    initCollapse();
    initModals();
    initTooltips();
  });

  // Export for global access
  window.bootstrap = {
    Tooltip: function(element) {
      // Simple tooltip constructor for compatibility
      return {
        show: function() {
          element.dispatchEvent(new Event('mouseenter'));
        },
        hide: function() {
          element.dispatchEvent(new Event('mouseleave'));
        }
      };
    }
  };

})();